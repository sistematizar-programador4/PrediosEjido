{% load humanize %}

{% load custom_filters %}

<html>
	<head>
		<title>{{ title }}</title>
		<style type="text/css">
			@page {
				size: Letter landscape;
				margin: 3.7cm 1cm 1.5cm;
				@frame footer {
					-pdf-frame-content: footerContent;
					bottom: 0cm;
					height: 1cm;
				}
				@frame header {
					top: 0.8cm;
					margin-right: 1cm;
					margin-left: 1cm;
					-pdf-frame-content: table;
				}
			}
			body {
				text-align: center;
				font-size: 11px;
				font-family: 'Courier New';
			}
			table {
				border-collapse: collapse;
			}
			td, th {
				padding: 1px 0px;
			}
		</style>
	</head>
	<body>
		<div>
			<table id="table">
				<tbody>
					<tr>
						<td colspan="12">---------------------------------------------------------------------------------------------------------------------------------------------------</td>
					</tr>
					<tr>
						<td colspan="12">INSTITUTO GEOGRÁFICO  "AGUSTIN CODAZZI"</td>
					</tr>
					<tr>
						<td>* * *</td>
						<td colspan="5">{{ title }}</td>
						<td colspan="4">FECHA DE PRODUCCIÓN</td>
						<td>{% now "d-M-Y" %}</td>
					</tr>
					<tr>
						<td colspan="6">CATASTRO DE: 73 TOLIMA</td>
						<td colspan="6">MUNICIPIO DE: 148 CÁRMEN DE APICALÁ</td>
					</tr>
					<tr>
						<td colspan="12">---------------------------------------------------------------------------------------------------------------------------------------------------</td>
					</tr>
				</tbody>
			</table>
			{% for predio in predios %}
				{% if predio.pago_set.all %}
					<table style="margin-bottom: 20px">
						<thead>
							<tr style="border-top:1px solid black;">
								<th style="padding-top: 5px;">Código catastro</th>
								<th style="padding-top: 5px;" colspan="3">Dirección del predio</th>
								<th style="padding-top: 5px;">Hectárea</th>
								<th style="padding-top: 5px;">Metros<sup>2</sup></th>
								<th style="padding-top: 5px;">Área construida</th>
								<th style="padding-top: 5px;">Avalúo catastral</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>{{ predio.c_catastral }}</td>
								<td colspan="3">{{ predio.dir_predio }}</td>
								<td>{{ predio.hectarea }}</td>
								<td>{{ predio.met2 }}</td>
								<td>{{ predio.area_con }}</td>
								<td>$ {{ predio.avaluo_catastral|floatformat|intcomma }}</td>
							</tr>
							<tr>
								<td colspan="8">---------------------------------------------------------------------------------------------------------------------------------------------------</td>
							</tr>
							<tr>
								<th colspan="3">Código recibo de caja</th>
								<th colspan="2">Fecha</th>
								<th colspan="3 ">Valor</th>
							</tr>
							{% for pago in predio.pago_set.all|sort_by:'f_recaja' %}
								<tr>
									<td colspan="3">{{ pago.c_recaja }}</td>
									<td colspan="2">{{ pago.f_recaja }}</td>
									<td colspan="3">$ {{ pago.v_recaja|floatformat|intcomma }}</td>
								</tr>
							{% endfor %}
							<tr>
								<td colspan="8">---------------------------------------------------------------------------------------------------------------------------------------------------</td>
							</tr>
							<tr>
								<th colspan="5">TOTAL</th>
								<th colspan="3">$ {{ predio.pk|sum_vrecaja|floatformat|intcomma }}</th>
							</tr>
						</tbody>
					</table>
				{% endif %}
			{% endfor %}
		</div>
		<div id="footerContent">
			HOJA NÚMERO <pdf:pagenumber>
		</div>
	</body>
</html>